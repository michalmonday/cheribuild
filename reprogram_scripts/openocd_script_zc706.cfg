
interface ftdi
transport select jtag
bindto 0.0.0.0
adapter_khz 1000
ftdi_tdo_sample_edge falling
ftdi_vid_pid 0x0403 0x6014
ftdi_channel 0
ftdi_layout_init 0x00e8 0x60eb

# Lines below were copied from from: 
# https://github.com/arduino/OpenOCD/blob/master/tcl/interface/ftdi/olimex-jtag-tiny.cfg

#interface ftdi
#ftdi_device_desc "Olimex OpenOCD JTAG TINY"
#ftdi_vid_pid 0x15ba 0x0004
#
#ftdi_layout_init 0x0808 0x0a1b
#ftdi_layout_signal nSRST -oe 0x0200
#ftdi_layout_signal nTRST -data 0x0100 -oe 0x0100
#ftdi_layout_signal LED -data 0x0800b
##
#transport select jtag
#adapter_khz 1000
#ftdi_channel 0

reset_config none

# TODO: bscan2

scan_chain

set _CHIPNAME riscv
#set _CHIPNAME auto0

jtag newtap $_CHIPNAME cpu -irlen 6 -ignore-version -expected-id 0x23731093
#jtag newtap $_CHIPNAME cpu -irlen 6 -expected-id 0x23731093
#jtag newtap $_CHIPNAME bs -irlen 18 -ignore-version -expected-id 0x23731093
#jtag newtap $_CHIPNAME bs -irlen 6 -ircapture 0x1 -irmask 0x03 -ignore-version -expected-id 0x23731093
#jtag newtap $_CHIPNAME cpu -irlen 6 -ircapture 0x1 -irmask 0x03 -ignore-version -expected-id 0x23731093
#jtag newtap $_CHIPNAME bs -irlen 10 -ircapture 0x1 -irmask 0x03 -ignore-version -expected-id 0x23731093
#jtag newtap $_CHIPNAME bs -irlen 18 -ircapture 0x1 -irmask 0x03 -ignore-version -expected-id 0x23731093
#jtag newtap $_CHIPNAME cpu -irlen 18 -ignore-version -expected-id 0x4ba00477

#jtag newtap auto0 tap -irlen 2 -expected-id 0x4ba00477

#jtag newtap arm_unused tap -irlen 4 -expected-id 0x4ba00477

set _TARGETNAME_0 $_CHIPNAME.cpu0
#set _TARGETNAME_0 $_CHIPNAME.bs0
#target create $_TARGETNAME_0 riscv -chain-position $_CHIPNAME.bs -coreid 0 -rtos hwthread
#target create $_TARGETNAME_0 riscv -chain-position $_CHIPNAME.tap -coreid 0 -rtos hwthread
target create $_TARGETNAME_0 riscv -chain-position $_CHIPNAME.cpu -coreid 0 -rtos hwthread

target smp $_TARGETNAME_0

#riscv set_ir dtmcs 0x022924
#riscv set_ir dmi 0x003924
riscv set_ir dtmcs 0x022
riscv set_ir dmi 0x003

init

halt
reset halt
